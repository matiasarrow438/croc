<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>$Gator The Alligator</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fuzzy+Bubbles:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="loading-screen">
        <div class="loading-content">
            <div class="loading-icon">üêä</div>
            <div class="loading-text">Loading...</div>
        </div>
    </div>

    <nav class="navbar">
        <div class="nav-content">
            <a href="/" class="nav-logo" style="text-decoration: none;">
                <span class="logo-icon">üêä</span>
                <span class="logo-text">$Gator</span>
            </a>
            <div class="nav-links">
                <a href="#play">Play Game</a>
                <a href="#gallery">Gallery</a>
                <a href="#tokenomics">Tokenomics</a>
                <div class="social-links">
                    <a href="#" target="_blank" class="social-icon">
                        <i class="fab fa-twitter"></i>
                    </a>
                    <a href="#" target="_blank" class="social-icon">
                        <i class="fab fa-discord"></i>
                    </a>
                    <a href="https://t.me/Gatorthealigator" target="_blank" class="social-icon">
                        <i class="fab fa-telegram"></i>
                    </a>
                    <a href="https://pump.fun" target="_blank" class="social-icon">
                        <img src="assets/pumpfun.png" alt="Pump.fun" class="pumpfun-icon">
                    </a>
                </div>
            </div>
            <button class="menu-toggle">‚ò∞</button>
        </div>
    </nav>

    <main>
        <section id="play" class="game-section">
            <div class="game-container">
                <div class="token-intro">
                    <div class="token-logo" style="display: flex; justify-content: center; align-items: center;">
                        <img src="assets/croc gif.gif" alt="$Gator Animation">
                    </div>
                    <h1 class="token-title">$Gator The Alligator</h1>
                </div>
                <div class="contract-display">
                    <div class="ticker"></div>
                    <div class="contract-info">
                        <span class="contract-label">OFFICIAL CA:</span>
                        <span class="contract-address">0x1234...5678</span>
                        <button class="copy-ca-button" onclick="copyContract()">
                            <i class="fas fa-copy"></i>
                            Copy
                        </button>
                    </div>
                </div>
                <div class="game-header">
                    <h2>CATCH THE COINS</h2>
                    <p>Use ‚Üê ‚Üí arrows to move Gator and catch falling coins!</p>
                </div>
                <div class="game-wrapper">
                    <canvas id="gameCanvas" width="800" height="400"></canvas>
                    <div class="game-overlay">
                        <div class="score">SCORE: <span id="scoreValue">0</span></div>
                        <div class="high-score">HIGH SCORE: <span id="highScoreValue">0</span></div>
                    </div>
                    <div class="pause-overlay">
                        <div class="pause-content">
                            <h2>PAUSED</h2>
                            <p>Click anywhere or switch back to this tab to resume</p>
                        </div>
                    </div>
                    <div class="instructions-overlay">
                        <div class="instructions-content">
                            <h2>How to Play</h2>
                            <div class="instructions-list">
                                <p>üéÆ Use <strong>WASD</strong> or <strong>Arrow Keys</strong> to move Gator</p>
                                <p>üí∞ Catch falling coins to score points</p>
                                <p>üí£ Avoid the bombs - they take away a life</p>
                                <p>‚ù§Ô∏è You have 3 lives to survive</p>
                            </div>
                            <button class="got-it-button" onclick="startGame()">Got it!</button>
                        </div>
                    </div>
                    <div class="game-over-overlay">
                        <div class="game-over-content">
                            <h2>Game Over!</h2>
                            <p>Your Score: <span id="finalScore">0</span></p>
                            <button class="try-again-button" onclick="restartGame()">Try Again</button>
                        </div>
                    </div>
                    <div class="mobile-controls">
                        <button class="control-button" id="leftButton" ontouchstart="handleMobileControl('left', true)" ontouchend="handleMobileControl('left', false)">
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <button class="control-button" id="rightButton" ontouchstart="handleMobileControl('right', true)" ontouchend="handleMobileControl('right', false)">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <section id="gallery" class="gallery-section">
            <div class="gallery-container">
                <div class="gallery-header">
                    <h2>GALLERY</h2>
                    <p>Check out our awesome $Gator!</p>
                </div>
                <div class="gallery-grid">
                    <div class="gallery-item">
                        <img src="assets/beach.jpg" alt="$Gator at Beach">
                        <div class="gallery-overlay">
                            <div class="gallery-caption">$Gator's Beach Adventure</div>
                        </div>
                    </div>
                    <div class="gallery-item zoom-image">
                        <img src="assets/lilypad.jpg" alt="$Gator on Lilypad" style="transform: scale(1);">
                        <div class="gallery-overlay">
                            <div class="gallery-caption">$Gator Chillin' on a Lilypad</div>
                        </div>
                    </div>
                    <div class="gallery-item zoom-image">
                        <img src="assets/jungle.jpg" alt="$Gator in Jungle" style="transform: scale(1);">
                        <div class="gallery-overlay">
                            <div class="gallery-caption">$Gator's Jungle Expedition</div>
                        </div>
                    </div>
                    <div class="gallery-item zoom-image">
                        <img src="assets/winter.jpg" alt="$Gator in Winter" style="transform: scale(1.);">
                        <div class="gallery-overlay">
                            <div class="gallery-caption">$Gator's Winter Wonderland</div>
                        </div>
                    </div>
                    <div class="gallery-item zoom-image">
                        <img src="assets/outdoors.jpg" alt="$Gator Outdoors" style="transform: scale(1.);">
                        <div class="gallery-overlay">
                            <div class="gallery-caption">$Gator's Nature Adventure</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="tokenomics" class="tokenomics-section">
            <div class="tokenomics-container">
                <div class="tokenomics-header">
                    <h2>TOKENOMICS</h2>
                    <p>$Gator The Alligator - Fair Launch, Community Driven</p>
                </div>
                <div class="tokenomics-grid">
                    <div class="tokenomics-item">
                        <div class="tokenomics-icon">üíé</div>
                        <h3>Total Supply</h3>
                        <p>1,000,000,000</p>
                        <p class="tokenomics-subtitle">1 Billion $Gator</p>
                    </div>
                    <div class="tokenomics-item">
                        <div class="tokenomics-icon">üîí</div>
                        <h3>Liquidity</h3>
                        <p>LOCKED</p>
                        <p class="tokenomics-subtitle">For Maximum Safety</p>
                    </div>
                    <div class="tokenomics-item">
                        <div class="tokenomics-icon">üí∞</div>
                        <h3>Tax</h3>
                        <p>0% Buy/Sell</p>
                        <p class="tokenomics-subtitle">Pure PumpFun Token</p>
                    </div>
                </div>
                <div class="tokenomics-details">
                    <div class="features-grid">
                        <div class="feature-card">
                            <div class="feature-icon">üöÄ</div>
                            <h3>Launch Ready</h3>
                            <p>Prepared for a successful takeoff.</p>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon">üîí</div>
                            <h3>Security First</h3>
                            <p>Liquidity locked for maximum safety and trust.</p>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon">üíé</div>
                            <h3>Community Driven</h3>
                            <p>Power to the holders, fully community owned.</p>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon">üéÆ</div>
                            <h3>Play4Fun</h3>
                            <p>Unique gaming experience</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <script>
        // Loading screen
        window.addEventListener('load', () => {
            setTimeout(() => {
                document.querySelector('.loading-screen').style.opacity = '0';
                setTimeout(() => {
                    document.querySelector('.loading-screen').style.display = 'none';
                }, 500);
            }, 1500);
        });

        // Audio elements
        const collectSound = new Audio('assets/collect.mp4');
        const bombSound = new Audio('assets/bomb.mp4');
        
        // Set volume and properties
        collectSound.volume = 0.25;
        bombSound.volume = 0.45;
        
        // Enable fast loading and autoplay
        collectSound.preload = 'auto';
        bombSound.preload = 'auto';
        collectSound.autoplay = true;
        bombSound.autoplay = true;
        
        // Preload sounds
        collectSound.load();
        bombSound.load();
        
        // Function to play sounds immediately
        function playSound(audio) {
            // Reset and play immediately
            audio.currentTime = 0;
            const promise = audio.play();
            if (promise !== undefined) {
                promise.catch(() => {
                    // If autoplay was prevented, try one more time on user interaction
                    document.addEventListener('click', function tryPlay() {
                        audio.play();
                        document.removeEventListener('click', tryPlay);
                    }, { once: true });
                });
            }
        }

        // Mobile menu
        document.querySelector('.menu-toggle').addEventListener('click', () => {
            document.querySelector('.nav-links').classList.toggle('active');
        });

        // Smooth scroll functionality
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    const navbarHeight = document.querySelector('.navbar').offsetHeight;
                    const windowHeight = window.innerHeight;
                    const targetHeight = target.offsetHeight;
                    
                    // Calculate position to center the target
                    let offsetPosition;
                    if (this.getAttribute('href') === '#play') {
                        // For game section, center it perfectly
                        offsetPosition = target.offsetTop - ((windowHeight - targetHeight) / 2);
                    } else {
                        // For other sections, just account for navbar
                        offsetPosition = target.offsetTop - navbarHeight;
                    }

                    window.scrollTo({
                        top: offsetPosition,
                        behavior: 'smooth'
                    });
                    // Close mobile menu if open
                    document.querySelector('.nav-links').classList.remove('active');
                }
            });
        });

        // Game functionality
        let canvas, ctx;
        let crocodileImage = new Image();
        let heartImage = new Image();
        let backgroundImage = new Image();
        crocodileImage.src = 'assets/CROC ICON.png';
        heartImage.src = './assets/heart.png';
        backgroundImage.src = 'assets/background.png';
        
        // Add image loading handlers
        heartImage.onload = function() {
            console.log('Heart image loaded successfully');
        };
        
        backgroundImage.onload = function() {
            console.log('Background image loaded successfully');
        };
        
        backgroundImage.onerror = function() {
            console.error('Failed to load background image');
        };
        
        let crocodile = {
            x: 400,
            y: 350,
            width: 80,
            height: 50,
            speed: 0.5,
            maxSpeed: 8,
            velocity: 0,
            friction: 0.92,
            direction: 1 // 1 for right, -1 for left
        };

        let coins = [];
        let bombs = [];
        let score = 0;
        let lives = 3;
        let highScore = localStorage.getItem('highScore') || 0;
        let gameLoop;
        let gameStarted = false;
        let coinSpawnInterval;
        let bombSpawnInterval;
        let isTabActive = true;
        let isPaused = false;
        let lastTimestamp = 0;

        let keys = {
            left: false,
            right: false
        };

        // Add visibility change handlers
        document.addEventListener('visibilitychange', handleVisibilityChange);
        window.addEventListener('blur', () => setTabActive(false));
        window.addEventListener('focus', () => setTabActive(true));

        function handleVisibilityChange() {
            if (document.hidden) {
                setTabActive(false);
            } else {
                setTabActive(true);
            }
        }

        function setTabActive(active) {
            isTabActive = active;
            if (!active && gameStarted) {
                // Pause game when tab is inactive
                isPaused = true;
                document.querySelector('.pause-overlay').style.display = 'flex';
                clearInterval(gameLoop);
                clearInterval(coinSpawnInterval);
                clearInterval(bombSpawnInterval);
            } else if (active && gameStarted) {
                // Resume game when tab is active again
                isPaused = false;
                document.querySelector('.pause-overlay').style.display = 'none';
                
                // Clear existing coins and bombs to prevent accumulation
                coins = [];
                bombs = [];
                
                // Reset timestamps and intervals
                lastTimestamp = performance.now();
                
                // Clear any existing intervals first
                clearInterval(gameLoop);
                clearInterval(coinSpawnInterval);
                clearInterval(bombSpawnInterval);
                
                // Start fresh intervals
                gameLoop = setInterval(update, 1000/60);
                coinSpawnInterval = setInterval(spawnCoin, 1000);
                bombSpawnInterval = setInterval(spawnBomb, 2000);
            }
        }

        function initGame() {
            canvas = document.getElementById('gameCanvas');
            ctx = canvas.getContext('2d');
            
            // Draw background first
            if (backgroundImage.complete && backgroundImage.naturalWidth !== 0) {
                ctx.drawImage(backgroundImage, 0, 0, canvas.width, canvas.height);
            } else {
                backgroundImage.onload = function() {
                    ctx.drawImage(backgroundImage, 0, 0, canvas.width, canvas.height);
                }
            }
            
            // Draw initial state
            drawCrocodile(crocodile.x, crocodile.y);
            drawLives();
            
            // Remove click to start listener
            canvas.removeEventListener('click', startGame);
            document.removeEventListener('keydown', startGameOnKey);
        }

        function startGameOnKey(e) {
            if (e.key === 'ArrowLeft' || e.key === 'ArrowRight' || 
                e.key.toLowerCase() === 'a' || e.key.toLowerCase() === 'd') {
                startGame();
                document.removeEventListener('keydown', startGameOnKey);
            }
        }

        function handleKeyDown(e) {
            switch(e.key.toLowerCase()) {
                case 'arrowleft':
                case 'a':
                    keys.left = true;
                    break;
                case 'arrowright':
                case 'd':
                    keys.right = true;
                    break;
            }
        }

        function handleKeyUp(e) {
            switch(e.key.toLowerCase()) {
                case 'arrowleft':
                case 'a':
                    keys.left = false;
                    break;
                case 'arrowright':
                case 'd':
                    keys.right = false;
                    break;
            }
        }

        function drawLives() {
            const heartSize = 40;
            const spacing = 5;
            const startX = canvas.width - 20 - (heartSize + spacing) * lives;
            const startY = 20;
            
            for (let i = 0; i < lives; i++) {
                if (heartImage.complete && heartImage.naturalWidth !== 0) {
                    ctx.drawImage(heartImage, startX + i * (heartSize + spacing), startY, heartSize, heartSize);
                }
            }
        }

        function spawnBomb() {
            if (isPaused) return;
            
            // Only spawn if we don't have too many bombs
            if (bombs.length < 3) {
                bombs.push({
                    x: Math.random() * (canvas.width - 30),
                    y: -30,
                    width: 30,
                    height: 30,
                    speed: 2 + Math.random() * 2
                });
            }
        }

        function startGame() {
            if (gameStarted) return;
            gameStarted = true;
            isPaused = false;
            lastTimestamp = performance.now();
            
            // Clear any existing entities
            coins = [];
            bombs = [];
            
            // Hide instructions overlay
            document.querySelector('.instructions-overlay').style.display = 'none';
            document.querySelector('.pause-overlay').style.display = 'none';
            
            // Reset score and lives
            score = 0;
            lives = 3;
            updateScore();
            
            // Clear any existing intervals first
            clearInterval(gameLoop);
            clearInterval(coinSpawnInterval);
            clearInterval(bombSpawnInterval);
            
            // Start loops only if tab is active
            if (isTabActive) {
                gameLoop = setInterval(update, 1000/60);
                coinSpawnInterval = setInterval(spawnCoin, 1000);
                bombSpawnInterval = setInterval(spawnBomb, 2000);
            }
            
            // Add controls
            document.addEventListener('keydown', handleKeyDown);
            document.addEventListener('keyup', handleKeyUp);
        }

        function spawnCoin() {
            if (isPaused) return;
            
            // Only spawn if we don't have too many coins
            if (coins.length < 5) {
                coins.push({
                    x: Math.random() * (canvas.width - 30),
                    y: -30,
                    width: 30,
                    height: 30,
                    speed: 2 + Math.random() * 2
                });
            }
        }

        function updateCrocodilePosition(deltaTime) {
            // Apply acceleration based on key presses
            if (keys.left) {
                crocodile.velocity -= crocodile.speed * deltaTime;
                crocodile.direction = -1;
            }
            if (keys.right) {
                crocodile.velocity += crocodile.speed * deltaTime;
                crocodile.direction = 1;
            }
            
            // Apply friction
            crocodile.velocity *= Math.pow(crocodile.friction, deltaTime);
            
            // Limit max speed
            crocodile.velocity = Math.max(Math.min(crocodile.velocity, crocodile.maxSpeed), -crocodile.maxSpeed);
            
            // Update position
            crocodile.x += crocodile.velocity * deltaTime;
            
            // Keep in bounds
            if (crocodile.x < 0) {
                crocodile.x = 0;
                crocodile.velocity = 0;
            } else if (crocodile.x > canvas.width - crocodile.width) {
                crocodile.x = canvas.width - crocodile.width;
                crocodile.velocity = 0;
            }
        }

        function updateScore() {
            document.getElementById('scoreValue').textContent = score;
            if (score > highScore) {
                highScore = score;
                localStorage.setItem('highScore', highScore);
                document.getElementById('highScoreValue').textContent = highScore;
            }
        }

        function drawCrocodile(x, y) {
            // If image is loaded, draw it
            if (crocodileImage.complete) {
                ctx.save();
                // If moving right, flip the image
                if (crocodile.direction === 1) {
                    ctx.scale(-1, 1);
                    ctx.drawImage(crocodileImage, -x - crocodile.width, y, crocodile.width, crocodile.height);
                } else {
                    ctx.drawImage(crocodileImage, x, y, crocodile.width, crocodile.height);
                }
                ctx.restore();
            }
        }

        function drawBomb(x, y) {
            // Add glow effect
            ctx.shadowColor = 'rgba(255, 0, 0, 0.5)';
            ctx.shadowBlur = 10;
            
            // Draw bomb body
            ctx.fillStyle = '#111'; // Darker color
            ctx.beginPath();
            ctx.arc(x + 15, y + 15, 12, 0, Math.PI * 2);
            ctx.fill();
            
            // Add highlight
            const gradient = ctx.createRadialGradient(
                x + 12, y + 12, 0,
                x + 15, y + 15, 12
            );
            gradient.addColorStop(0, 'rgba(100, 100, 100, 0.5)');
            gradient.addColorStop(1, 'rgba(0, 0, 0, 0)');
            ctx.fillStyle = gradient;
            ctx.beginPath();
            ctx.arc(x + 15, y + 15, 12, 0, Math.PI * 2);
            ctx.fill();
            
            // Draw fuse
            ctx.shadowBlur = 0; // Reset shadow for fuse
            ctx.strokeStyle = '#8B4513';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(x + 15, y + 3);
            ctx.lineTo(x + 15, y + 15);
            ctx.stroke();
            
            // Draw spark with glow
            ctx.shadowColor = '#FFD700';
            ctx.shadowBlur = 15;
            ctx.fillStyle = '#FF4500';
            ctx.beginPath();
            ctx.arc(x + 15, y + 3, 3, 0, Math.PI * 2);
            ctx.fill();
            
            // Reset shadow
            ctx.shadowBlur = 0;
        }

        // Add collision cooldown
        let lastBombHit = 0;
        const BOMB_COOLDOWN = 500; // 500ms cooldown after bomb hit

        // Move collision detection to be more immediate
        function checkCollisions(coin, i) {
            // Don't collect coins right after bomb hit
            if (Date.now() - lastBombHit < BOMB_COOLDOWN) {
                return false;
            }

            if (coin.y + coin.height > crocodile.y &&
                coin.x < crocodile.x + crocodile.width &&
                coin.x + coin.width > crocodile.x) {
                // Play sound first
                playSound(collectSound);
                // Then handle other collision effects
                coins.splice(i, 1);
                score += 10;
                updateScore();
                return true;
            }
            return false;
        }

        // Update bomb collision to set the cooldown
        function checkBombCollision(bomb, i) {
            if (bomb.y + bomb.height > crocodile.y &&
                bomb.x < crocodile.x + crocodile.width &&
                bomb.x + bomb.width > crocodile.x) {
                bombs.splice(i, 1);
                lives--;
                lastBombHit = Date.now(); // Set the cooldown timestamp
                playSound(bombSound);
                if (lives <= 0) {
                    // Game over
                    clearInterval(gameLoop);
                    gameStarted = false;
                    document.getElementById('finalScore').textContent = score;
                    document.querySelector('.game-over-overlay').style.display = 'flex';
                }
                return true;
            }
            return false;
        }

        function update() {
            if (isPaused) return;

            const currentTime = performance.now();
            const deltaTime = Math.min((currentTime - lastTimestamp) / 16.67, 3); // Cap deltaTime to prevent huge jumps
            lastTimestamp = currentTime;

            // Clear canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Draw background
            if (backgroundImage.complete && backgroundImage.naturalWidth !== 0) {
                ctx.drawImage(backgroundImage, 0, 0, canvas.width, canvas.height);
            }
            
            // Update crocodile position with deltaTime
            updateCrocodilePosition(deltaTime);
            
            // Draw lives
            drawLives();
            
            // Draw crocodile
            drawCrocodile(crocodile.x, crocodile.y);
            
            // Safety check for arrays
            if (coins.length > 5) coins.length = 5;
            if (bombs.length > 3) bombs.length = 3;
            
            // Update and draw coins with deltaTime
            for (let i = coins.length - 1; i >= 0; i--) {
                const coin = coins[i];
                coin.y += coin.speed * deltaTime;
                
                // Check collision first, before drawing
                if (checkCollisions(coin, i)) {
                    continue; // Skip drawing if collected
                }
                
                // Draw coin with gradient
                const gradient = ctx.createRadialGradient(
                    coin.x + coin.width/2, 
                    coin.y + coin.height/2, 
                    0,
                    coin.x + coin.width/2, 
                    coin.y + coin.height/2, 
                    coin.width/2
                );
                gradient.addColorStop(0, '#FFD700');
                gradient.addColorStop(0.5, '#DAA520');
                gradient.addColorStop(1, '#B8860B');
                
                ctx.fillStyle = gradient;
                ctx.beginPath();
                ctx.arc(coin.x + coin.width/2, coin.y + coin.height/2, coin.width/2, 0, Math.PI * 2);
                ctx.fill();
                
                ctx.strokeStyle = '#8B4513';
                ctx.lineWidth = 2;
                ctx.beginPath();
                ctx.arc(coin.x + coin.width/2, coin.y + coin.height/2, coin.width/2, 0, Math.PI * 2);
                ctx.stroke();
                
                const shineGradient = ctx.createRadialGradient(
                    coin.x + coin.width/3, 
                    coin.y + coin.height/3, 
                    0,
                    coin.x + coin.width/3, 
                    coin.y + coin.height/3, 
                    coin.width/4
                );
                shineGradient.addColorStop(0, 'rgba(255, 255, 255, 0.8)');
                shineGradient.addColorStop(1, 'rgba(255, 255, 255, 0)');
                
                ctx.fillStyle = shineGradient;
                ctx.beginPath();
                ctx.arc(coin.x + coin.width/3, coin.y + coin.height/3, coin.width/4, 0, Math.PI * 2);
                ctx.fill();
                
                ctx.fillStyle = '#8B4513';
                ctx.font = 'bold 16px Arial';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText('$', coin.x + coin.width/2, coin.y + coin.height/2);
            }

            // Update and draw bombs with deltaTime
            for (let i = bombs.length - 1; i >= 0; i--) {
                const bomb = bombs[i];
                bomb.y += bomb.speed * deltaTime;
                
                drawBomb(bomb.x, bomb.y);
                
                // Check bomb collision
                if (checkBombCollision(bomb, i)) {
                    continue;
                }
                
                if (bomb.y > canvas.height) {
                    bombs.splice(i, 1);
                }
            }
        }

        // Initialize game when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            initGame();
            document.getElementById('highScoreValue').textContent = highScore;
        });

        // Scroll functionality
        function scrollToGame() {
            document.getElementById('play').scrollIntoView({ behavior: 'smooth' });
            if (!gameStarted) {
                initGame();
            }
        }

        // Add restart game function
        function restartGame() {
            // Hide game over overlay
            document.querySelector('.game-over-overlay').style.display = 'none';
            
            // Reset game state
            score = 0;
            lives = 3;
            coins = [];
            bombs = [];
            crocodile.x = 400;
            crocodile.velocity = 0;
            updateScore();
            
            // Start game only if tab is active
            gameStarted = true;
            if (isTabActive) {
                gameLoop = setInterval(update, 1000/60);
                coinSpawnInterval = setInterval(spawnCoin, 1000);
                bombSpawnInterval = setInterval(spawnBomb, 2000);
            }
        }

        // Add click handler to resume game
        document.addEventListener('click', function() {
            if (isPaused && gameStarted) {
                setTabActive(true);
            }
        });

        // Add copyContract function
        function copyContract() {
            const contractAddress = "0x1234...5678";
            navigator.clipboard.writeText(contractAddress).then(() => {
                const button = document.querySelector('.copy-ca-button');
                button.innerHTML = '<i class="fas fa-check"></i> Copied!';
                button.classList.add('copied');
                setTimeout(() => {
                    button.innerHTML = '<i class="fas fa-copy"></i> Copy';
                    button.classList.remove('copied');
                }, 2000);
            });
        }

        // Mobile Controls Handler
        function handleMobileControl(direction, isPressed) {
            // Only prevent default for the control buttons
            if (event.target.classList.contains('control-button')) {
                event.preventDefault();
            }
            
            // Update keys state based on touch
            if (direction === 'left') {
                keys.left = isPressed;
            } else if (direction === 'right') {
                keys.right = isPressed;
            }
            
            // Start game if it hasn't started yet
            if (!gameStarted && isPressed) {
                startGame();
            }
        }
    </script>
</body>
</html>        
